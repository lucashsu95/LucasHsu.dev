import{_ as d,c as E,b as A,w as n,au as g,m as s,J as a,a as i,V as k,E as h,o as t}from"./chunks/framework.C9sE8QFS.js";const H=JSON.parse('{"title":"SQL CASE WHEN THEN 條件運算完整指南 | LucasHsu.dev","description":"深入學習 SQL CASE 條件運算，涵蓋基礎語法、條件聚合、自訂排序與批次更新，附決策樹圖與實戰練習。","frontmatter":{"title":"SQL CASE WHEN THEN 條件運算完整指南 | LucasHsu.dev","description":"深入學習 SQL CASE 條件運算，涵蓋基礎語法、條件聚合、自訂排序與批次更新，附決策樹圖與實戰練習。","head":[["meta",{"name":"keywords","content":"SQL,CASE WHEN THEN,條件運算,條件聚合,自訂排序,SQL實戰,資料庫查詢"}],["meta",{"property":"og:title","content":"SQL CASE WHEN THEN 條件運算完整指南"}],["meta",{"property":"og:description","content":"深入學習 SQL CASE 條件運算，涵蓋基礎語法、條件聚合、自訂排序與批次更新，附決策樹圖與實戰練習。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://lucashsu95.github.io/LucasHsu.dev/images/sql-cover.jpg"}]]},"headers":[],"relativePath":"database/sql/sql-case-when-then.md","filePath":"database/sql/sql-case-when-then.md","lastUpdated":1769139886000}'),D={name:"database/sql/sql-case-when-then.md"},y=k(`<h1 id="sql-case-when-then" tabindex="-1">SQL CASE...WHEN...THEN <a class="header-anchor" href="#sql-case-when-then" aria-label="Permalink to &quot;SQL CASE...WHEN...THEN&quot;">​</a></h1><blockquote><p>📝 TL;DR：CASE 是 SQL 的條件運算器，可在 SELECT、ORDER BY、UPDATE 中根據條件回傳不同值，支援巢狀、條件聚合與客製排序，是實現複雜業務邏輯的核心工具。</p></blockquote><h2 id="前置知識" tabindex="-1">前置知識 <a class="header-anchor" href="#前置知識" aria-label="Permalink to &quot;前置知識&quot;">​</a></h2><p>在開始之前，建議你先了解以下概念：</p><ul><li><strong>基本 SQL 語法</strong> - SELECT、WHERE、GROUP BY 的基礎使用</li><li><strong>布林邏輯</strong> - AND、OR、NOT 的運算規則</li><li><strong>聚合函式</strong> - COUNT、SUM、AVG 等函式的基本用法</li></ul><h2 id="什麼是-case" tabindex="-1">什麼是 CASE？ <a class="header-anchor" href="#什麼是-case" aria-label="Permalink to &quot;什麼是 CASE？&quot;">​</a></h2><h3 id="為什麼需要學習它" tabindex="-1">為什麼需要學習它？ <a class="header-anchor" href="#為什麼需要學習它" aria-label="Permalink to &quot;為什麼需要學習它？&quot;">​</a></h3><p>CASE 表達式就像程式語言中的 if-else，但它運作在 SQL 查詢內部：</p><ul><li><strong>解決什麼問題？</strong> 需要根據不同條件顯示不同結果、進行條件計算或自訂排序</li><li><strong>有什麼優勢？</strong> 一次查詢即可完成複雜的條件邏輯，無需多次查詢或應用層處理</li><li><strong>什麼時候會用到？</strong> 資料分類標籤、條件聚合統計、客製化排序、批次更新等場景</li></ul><h3 id="核心概念" tabindex="-1">核心概念 <a class="header-anchor" href="#核心概念" aria-label="Permalink to &quot;核心概念&quot;">​</a></h3><p>CASE 是一種<strong>條件表達式</strong>，會依序檢查每個 WHEN 條件，回傳第一個符合條件的 THEN 結果，若都不符合則回傳 ELSE 的預設值。</p><div class="warning custom-block"><p class="custom-block-title">⚠️ 注意</p><ul><li>CASE 會回傳<strong>第一個</strong>符合的條件結果，之後的條件不再檢查</li><li>所有 THEN 和 ELSE 回傳的資料型別應該一致</li><li>處理 NULL 值時需使用 <code>IS NULL</code> 而非 <code>= NULL</code></li></ul></div><h2 id="💻-基本語法" tabindex="-1">💻 基本語法 <a class="header-anchor" href="#💻-基本語法" aria-label="Permalink to &quot;💻 基本語法&quot;">​</a></h2><h3 id="語法結構" tabindex="-1">語法結構 <a class="header-anchor" href="#語法結構" aria-label="Permalink to &quot;語法結構&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- Searched CASE（條件判斷型）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> condition1 </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> result1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> condition2 </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> result2</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> condition3 </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> result3</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ELSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> default_result</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- Simple CASE（值比對型）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> expression</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> value1 </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> result1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> value2 </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> result2</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ELSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> default_result</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span></span></code></pre></div><h3 id="參數說明" tabindex="-1">參數說明 <a class="header-anchor" href="#參數說明" aria-label="Permalink to &quot;參數說明&quot;">​</a></h3><table><thead><tr><th>元素</th><th>說明</th><th>必填</th></tr></thead><tbody><tr><td>WHEN</td><td>條件判斷式，可使用任何布林運算</td><td>是</td></tr><tr><td>THEN</td><td>條件成立時回傳的結果</td><td>是</td></tr><tr><td>ELSE</td><td>所有條件都不成立時的預設值</td><td>否</td></tr><tr><td>END</td><td>結束 CASE 表達式</td><td>是</td></tr><tr><td>expression</td><td>Simple CASE 中要比對的欄位或表達式（選用）</td><td>否</td></tr></tbody></table><h2 id="視覺化說明-case-決策樹" tabindex="-1">視覺化說明：CASE 決策樹 <a class="header-anchor" href="#視覺化說明-case-決策樹" aria-label="Permalink to &quot;視覺化說明：CASE 決策樹&quot;">​</a></h2>`,18),C=k(`<h2 id="實際範例" tabindex="-1">實際範例 <a class="header-anchor" href="#實際範例" aria-label="Permalink to &quot;實際範例&quot;">​</a></h2><h3 id="範例-1-基礎應用-薪資分級" tabindex="-1">範例 1：基礎應用 - 薪資分級 <a class="header-anchor" href="#範例-1-基礎應用-薪資分級" aria-label="Permalink to &quot;範例 1：基礎應用 - 薪資分級&quot;">​</a></h3><p><strong>情境說明：</strong> 我們有一個員工表，需要根據薪資範圍為員工貼上等級標籤。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employee_id,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    salary,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">初級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BETWEEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AND</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">中級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">高級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">未分類</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary_grade</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employees;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 輸出結果：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- employee_id | salary | salary_grade</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ------------|--------|-------------</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 1           | 25000  | 初級</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 2           | 45000  | 中級</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 3           | 60000  | 高級</span></span></code></pre></div><p><strong>程式碼說明：</strong></p><ol><li>依序檢查每個 WHEN 條件</li><li>salary &lt; 30000 為真時，立即回傳「初級」並結束判斷</li><li>若都不符合，回傳 ELSE 的「未分類」</li></ol><h3 id="範例-2-條件聚合統計" tabindex="-1">範例 2：條件聚合統計 <a class="header-anchor" href="#範例-2-條件聚合統計" aria-label="Permalink to &quot;範例 2：條件聚合統計&quot;">​</a></h3><p><strong>情境說明：</strong> 統計各部門男女員工的平均薪資，一次查詢完成。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    department,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    AVG</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> gender </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Male</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> avg_male_salary,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    AVG</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> gender </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Female</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> avg_female_salary,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    COUNT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> gender </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Male</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> male_count</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employees</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GROUP BY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    department;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 輸出結果：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- department | avg_male_salary | avg_female_salary | male_count</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- -----------|-----------------|-------------------|------------</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- IT         | 55000           | 52000             | 15</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- Sales      | 48000           | 46000             | 20</span></span></code></pre></div><p><strong>程式碼說明：</strong></p><ol><li>在聚合函式內使用 CASE，只計算符合條件的值</li><li>不符合條件時回傳 NULL，不影響 AVG 計算</li><li>COUNT 搭配 CASE 可統計特定條件的筆數</li></ol><h3 id="範例-3-自訂排序邏輯" tabindex="-1">範例 3：自訂排序邏輯 <a class="header-anchor" href="#範例-3-自訂排序邏輯" aria-label="Permalink to &quot;範例 3：自訂排序邏輯&quot;">​</a></h3><p><strong>情境說明：</strong> 訂單列表需要優先顯示「緊急」訂單，再來是「處理中」，最後是「已完成」。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    order_id, </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    status</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    created_at</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    orders</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ORDER BY</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">urgent</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">processing</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">completed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    created_at </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DESC</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><p><strong>程式碼說明：</strong></p><ol><li>ORDER BY 中使用 CASE 指定每個狀態的排序權重</li><li>數字越小排序越前面</li><li>同狀態內再依 created_at 降冪排序</li></ol><h3 id="範例-4-批次調整薪資" tabindex="-1">範例 4：批次調整薪資 <a class="header-anchor" href="#範例-4-批次調整薪資" aria-label="Permalink to &quot;範例 4：批次調整薪資&quot;">​</a></h3><p><strong>情境說明：</strong> 根據績效評等批次調整員工獎金。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">UPDATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> employees</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SET</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> bonus </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> performance_rating </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Excellent</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> performance_rating </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Good</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">05</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> performance_rating </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Average</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">02</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><p><strong>程式碼說明：</strong></p><ol><li>UPDATE 搭配 CASE 可一次性依不同條件更新</li><li>避免多次 UPDATE 語句，提升效能</li><li>ELSE 0 確保沒有評等的員工獎金為 0</li></ol><h3 id="範例-5-巢狀-case-複雜判斷" tabindex="-1">範例 5：巢狀 CASE（複雜判斷） <a class="header-anchor" href="#範例-5-巢狀-case-複雜判斷" aria-label="Permalink to &quot;範例 5：巢狀 CASE（複雜判斷）&quot;">​</a></h3><p><strong>情境說明：</strong> 業務部門需要更細緻的績效分級。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employee_id,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    department,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> department </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Sales</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            CASE</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sales_amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 100000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">S級業務</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sales_amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">A級業務</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sales_amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">B級業務</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">C級業務</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            END</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> department </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">IT</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">IT人員</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">一般員工</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> performance_level</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employees;</span></span></code></pre></div><h2 id="實戰練習" tabindex="-1">實戰練習 <a class="header-anchor" href="#實戰練習" aria-label="Permalink to &quot;實戰練習&quot;">​</a></h2><h3 id="練習-1-基礎應用-簡單-⭐" tabindex="-1">練習 1：基礎應用（簡單）⭐ <a class="header-anchor" href="#練習-1-基礎應用-簡單-⭐" aria-label="Permalink to &quot;練習 1：基礎應用（簡單）⭐&quot;">​</a></h3><p><strong>任務：</strong> 請為學生成績表建立及格/不及格標籤。</p><p>資料表 <code>students</code> 有欄位：<code>student_id</code>, <code>name</code>, <code>score</code></p><p><strong>提示：</strong></p><ul><li>60 分以上為「及格」</li><li>60 分以下為「不及格」</li></ul><details class="details custom-block"><summary>參考答案</summary><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    student_id,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    score,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> score </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 60</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">及格</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">不及格</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> pass_status</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    students;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 輸出結果：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- student_id | name  | score | pass_status</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- -----------|-------|-------|-------------</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 1          | 小明  | 75    | 及格</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 2          | 小華  | 45    | 不及格</span></span></code></pre></div><p><strong>說明：</strong> 使用簡單的 CASE 判斷，score &gt;= 60 時回傳「及格」，否則回傳「不及格」。</p></details><h3 id="練習-2-條件計數-簡單-⭐" tabindex="-1">練習 2：條件計數（簡單）⭐ <a class="header-anchor" href="#練習-2-條件計數-簡單-⭐" aria-label="Permalink to &quot;練習 2：條件計數（簡單）⭐&quot;">​</a></h3><p><strong>任務：</strong> 統計各部門「高薪」（&gt;50000）和「一般薪資」（&lt;=50000）的員工人數。</p><p><strong>思考方向：</strong></p><ul><li>使用 COUNT + CASE 組合</li><li>在 GROUP BY department 後分組統計</li></ul><details class="details custom-block"><summary>參考答案</summary><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    department,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    COUNT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> high_salary_count,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    COUNT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> normal_salary_count</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employees</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GROUP BY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    department;</span></span></code></pre></div><p><strong>說明：</strong></p><ol><li>COUNT 只計算非 NULL 值</li><li>CASE 符合條件時回傳 1，否則回傳 NULL</li><li>這樣可以在一次查詢中同時統計兩種條件</li></ol></details><h3 id="練習-3-綜合應用-中等-⭐⭐" tabindex="-1">練習 3：綜合應用（中等）⭐⭐ <a class="header-anchor" href="#練習-3-綜合應用-中等-⭐⭐" aria-label="Permalink to &quot;練習 3：綜合應用（中等）⭐⭐&quot;">​</a></h3><p><strong>任務：</strong> 建立一個複雜的客戶等級系統。</p><p><strong>需求：</strong></p><ol><li>VIP 客戶（總消費 &gt; 100000）給予「鑽石會員」</li><li>一般客戶（總消費 50000-100000）且訂單數 &gt; 10 給予「金牌會員」</li><li>一般客戶（總消費 50000-100000）且訂單數 &lt;= 10 給予「銀牌會員」</li><li>其餘給予「一般會員」</li></ol><p><strong>提示：</strong></p><ul><li>需要 JOIN customers 和 orders 表</li><li>使用 SUM 和 COUNT 計算總消費和訂單數</li><li>巢狀 CASE 處理複雜條件</li></ul><details class="details custom-block"><summary>參考答案與解題思路</summary><p><strong>解題思路：</strong></p><ol><li>先用子查詢或 CTE 計算每個客戶的總消費和訂單數</li><li>外層查詢使用巢狀 CASE 判斷等級</li><li>注意條件的優先順序</li></ol><p><strong>參考程式碼：</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WITH</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> customer_stats </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">customer_id</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">        SUM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">o</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">amount</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> total_spent,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">        COUNT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">o</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">order_id</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> order_count</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        customers c</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        LEFT JOIN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders o </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">customer_id</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> o</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">customer_id</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    GROUP BY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">        c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">customer_id</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">c</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">name</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    customer_id,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    total_spent,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    order_count,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> total_spent </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 100000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">鑽石會員</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> total_spent </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BETWEEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AND</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 100000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> order_count </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">金牌會員</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">銀牌會員</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            END</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">一般會員</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> membership_level</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    customer_stats</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ORDER BY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    total_spent </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DESC</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><p><strong>延伸思考：</strong></p><ul><li>如何優化此查詢效能？（考慮索引）</li><li>如果要加入「最近一年消費」條件該如何修改？</li><li>實際專案中可能需要定期更新會員等級，如何實作自動化？</li></ul></details><h2 id="常見問題-faq" tabindex="-1">常見問題 FAQ <a class="header-anchor" href="#常見問題-faq" aria-label="Permalink to &quot;常見問題 FAQ&quot;">​</a></h2><h3 id="q1-case-可以在-where-子句中使用嗎" tabindex="-1">Q1: CASE 可以在 WHERE 子句中使用嗎？ <a class="header-anchor" href="#q1-case-可以在-where-子句中使用嗎" aria-label="Permalink to &quot;Q1: CASE 可以在 WHERE 子句中使用嗎？&quot;">​</a></h3><p><strong>A:</strong> 可以，但通常不建議。WHERE 中的 CASE 會讓查詢優化器難以使用索引。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ 不推薦（無法使用索引）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> CASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHEN</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">active</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ELSE</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> END</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 推薦（可使用索引）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">active</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span></code></pre></div><h3 id="q2-case-與-if-decode-的差別是什麼" tabindex="-1">Q2: CASE 與 IF/DECODE 的差別是什麼？ <a class="header-anchor" href="#q2-case-與-if-decode-的差別是什麼" aria-label="Permalink to &quot;Q2: CASE 與 IF/DECODE 的差別是什麼？&quot;">​</a></h3><p><strong>A:</strong> 比較說明：</p><table><thead><tr><th>項目</th><th>CASE</th><th>IF</th><th>DECODE</th></tr></thead><tbody><tr><td>標準</td><td>SQL 標準，跨資料庫通用</td><td>MySQL 專用</td><td>Oracle 專用</td></tr><tr><td>可讀性</td><td>高，結構清晰</td><td>中等</td><td>較低</td></tr><tr><td>巢狀支援</td><td>佳，可多層巢狀</td><td>可巢狀但較難閱讀</td><td>有限</td></tr><tr><td>條件複雜度</td><td>支援複雜布林條件</td><td>支援</td><td>僅支援等值比對</td></tr></tbody></table><p><strong>建議：</strong> 優先使用 CASE，因為它是 SQL 標準且可讀性最佳。</p><h3 id="q3-case-中如何處理-null-值" tabindex="-1">Q3: CASE 中如何處理 NULL 值？ <a class="header-anchor" href="#q3-case-中如何處理-null-值" aria-label="Permalink to &quot;Q3: CASE 中如何處理 NULL 值？&quot;">​</a></h3><p><strong>A:</strong> 必須使用 <code>IS NULL</code> 或 <code>IS NOT NULL</code>，不能用 <code>= NULL</code>。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 正確</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> column </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">IS</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> NULL</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">無資料</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ELSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> column</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ 錯誤（永遠不會成立）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> column </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> NULL</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">無資料</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    ELSE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> column</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span></span></code></pre></div><h3 id="q4-case-會影響查詢效能嗎" tabindex="-1">Q4: CASE 會影響查詢效能嗎？ <a class="header-anchor" href="#q4-case-會影響查詢效能嗎" aria-label="Permalink to &quot;Q4: CASE 會影響查詢效能嗎？&quot;">​</a></h3><p><strong>A:</strong> CASE 本身運算輕量，但要注意：</p><ul><li>在大量資料上避免在 WHERE 中使用 CASE（破壞索引）</li><li>SELECT 中的 CASE 對效能影響很小</li><li>複雜巢狀 CASE 可能影響可讀性，但對效能影響有限</li><li></li></ul><h2 id="最佳實踐" tabindex="-1">最佳實踐 <a class="header-anchor" href="#最佳實踐" aria-label="Permalink to &quot;最佳實踐&quot;">​</a></h2><h3 id="✅-推薦做法" tabindex="-1">✅ 推薦做法 <a class="header-anchor" href="#✅-推薦做法" aria-label="Permalink to &quot;✅ 推薦做法&quot;">​</a></h3><ol><li><strong>使用明確的 ELSE</strong> - 即使邏輯上不需要，也建議加上 ELSE，提高可讀性</li><li><strong>條件順序優化</strong> - 把最常見的條件放在最前面，減少判斷次數</li><li><strong>避免過度巢狀</strong> - 超過 2 層巢狀建議改用 JOIN 或子查詢</li><li><strong>統一資料型別</strong> - 確保所有 THEN 和 ELSE 回傳相同型別</li></ol><h3 id="❌-常見錯誤" tabindex="-1">❌ 常見錯誤 <a class="header-anchor" href="#❌-常見錯誤" aria-label="Permalink to &quot;❌ 常見錯誤&quot;">​</a></h3><ol><li><strong>忘記 END</strong> - CASE 必須用 END 結尾</li><li><strong>型別不一致</strong> - 不同分支回傳不同型別可能導致錯誤</li><li><strong>NULL 判斷錯誤</strong> - 使用 <code>= NULL</code> 而非 <code>IS NULL</code></li><li><strong>在 WHERE 濫用</strong> - 破壞索引效能</li></ol><h2 id="延伸閱讀" tabindex="-1">延伸閱讀 <a class="header-anchor" href="#延伸閱讀" aria-label="Permalink to &quot;延伸閱讀&quot;">​</a></h2><h3 id="相關文章" tabindex="-1">相關文章 <a class="header-anchor" href="#相關文章" aria-label="Permalink to &quot;相關文章&quot;">​</a></h3><p>本站相關主題：</p>`,65),o=s("h3",{id:"推薦資源",tabindex:"-1"},[i("推薦資源 "),s("a",{class:"header-anchor",href:"#推薦資源","aria-label":'Permalink to "推薦資源"'},"​")],-1),c=s("p",null,"外部優質資源：",-1),B=k(`<h2 id="總結" tabindex="-1">總結 <a class="header-anchor" href="#總結" aria-label="Permalink to &quot;總結&quot;">​</a></h2><p>用 4 個重點總結這篇文章：</p><ol><li><strong>條件邏輯</strong> - CASE 是 SQL 的 if-else，依序判斷條件並回傳結果</li><li><strong>應用場景</strong> - 可用於 SELECT（分類標籤）、ORDER BY（自訂排序）、聚合函式（條件統計）、UPDATE（批次更新）</li><li><strong>最佳實踐</strong> - 使用明確 ELSE、避免過度巢狀、注意型別一致性</li><li><strong>效能考量</strong> - 避免在 WHERE 使用 CASE，SELECT 中使用對效能影響小</li></ol><h2 id="進階語法-保留舊內容" tabindex="-1">進階語法（保留舊內容） <a class="header-anchor" href="#進階語法-保留舊內容" aria-label="Permalink to &quot;進階語法（保留舊內容）&quot;">​</a></h2><h3 id="_1-在-group-by-中使用-case" tabindex="-1">1. 在 GROUP BY 中使用 CASE: <a class="header-anchor" href="#_1-在-group-by-中使用-case" aria-label="Permalink to &quot;1. 在 GROUP BY 中使用 CASE:&quot;">​</a></h3><h3 id="_1-在-group-by-中使用-case-1" tabindex="-1">1. 在 GROUP BY 中使用 CASE: <a class="header-anchor" href="#_1-在-group-by-中使用-case-1" aria-label="Permalink to &quot;1. 在 GROUP BY 中使用 CASE:&quot;">​</a></h3><p>假設我們想按照薪資等級對員工進行分組統計:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">初級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BETWEEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AND</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">中級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">高級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">未分類</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary_grade,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    COUNT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> employee_count</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employees</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GROUP BY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">初級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BETWEEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AND</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">中級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">高級</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">未分類</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><h3 id="_2-在-order-by-中使用-case" tabindex="-1">2. 在 ORDER BY 中使用 CASE: <a class="header-anchor" href="#_2-在-order-by-中使用-case" aria-label="Permalink to &quot;2. 在 ORDER BY 中使用 CASE:&quot;">​</a></h3><p>我們可以使用 CASE 來自定義排序邏輯:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employee_id, </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    department, </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    salary</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employees</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ORDER BY</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> department </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">IT</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> department </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Sales</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> department </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">HR</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    salary </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DESC</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><h3 id="_3-使用-case-進行條件聚合" tabindex="-1">3. 使用 CASE 進行條件聚合: <a class="header-anchor" href="#_3-使用-case-進行條件聚合" aria-label="Permalink to &quot;3. 使用 CASE 進行條件聚合:&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    department,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    AVG</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> gender </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Male</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> avg_male_salary,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    AVG</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CASE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> gender </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Female</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> avg_female_salary</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employees</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">GROUP BY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    department;</span></span></code></pre></div><h3 id="_4-在-update-語句中使用-case" tabindex="-1">4. 在 UPDATE 語句中使用 CASE: <a class="header-anchor" href="#_4-在-update-語句中使用-case" aria-label="Permalink to &quot;4. 在 UPDATE 語句中使用 CASE:&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">UPDATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> employees</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SET</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> bonus </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> performance_rating </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Excellent</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> performance_rating </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Good</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> salary </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">05</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><h3 id="_5-巢狀-case-語句" tabindex="-1">5. 巢狀 CASE 語句: <a class="header-anchor" href="#_5-巢狀-case-語句" aria-label="Permalink to &quot;5. 巢狀 CASE 語句:&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employee_id,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    CASE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> department </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Sales</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            CASE</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sales_amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Top Performer</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                WHEN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sales_amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 30000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> THEN</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Good Performer</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">                ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Average Performer</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            END</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        ELSE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">N/A</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AS</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> sales_performance</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    employees;</span></span></code></pre></div><p>這些舊版範例展示了 CASE 語句的多樣性和靈活性。它不僅可以用於簡單的條件邏輯，還可以在複雜的查詢、分組、排序和更新操作中發揮重要作用。</p>`,18);function F(u,S,m,N,b,_){const p=h("Mermaid"),l=h("VPNolebaseInlineLinkPreview"),e=h("NolebaseGitContributors"),r=h("NolebaseGitChangelog");return t(),E("div",null,[y,(t(),A(g,null,{default:n(()=>[a(p,{id:"mermaid-167",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20A%5B%E9%96%8B%E5%A7%8B%20CASE%20%E5%88%A4%E6%96%B7%5D%20--%3E%20B%7BWHEN%20condition1%3F%7D%0A%20%20%20%20B%20--%3E%7C%E6%98%AF%7C%20C%5B%E5%9B%9E%E5%82%B3%20result1%5D%0A%20%20%20%20B%20--%3E%7C%E5%90%A6%7C%20D%7BWHEN%20condition2%3F%7D%0A%20%20%20%20D%20--%3E%7C%E6%98%AF%7C%20E%5B%E5%9B%9E%E5%82%B3%20result2%5D%0A%20%20%20%20D%20--%3E%7C%E5%90%A6%7C%20F%7BWHEN%20condition3%3F%7D%0A%20%20%20%20F%20--%3E%7C%E6%98%AF%7C%20G%5B%E5%9B%9E%E5%82%B3%20result3%5D%0A%20%20%20%20F%20--%3E%7C%E5%90%A6%7C%20H%5B%E5%9B%9E%E5%82%B3%20ELSE%20%E9%A0%90%E8%A8%AD%E5%80%BC%5D%0A%20%20%20%20C%20--%3E%20I%5BEND%5D%0A%20%20%20%20E%20--%3E%20I%0A%20%20%20%20G%20--%3E%20I%0A%20%20%20%20H%20--%3E%20I%0A"})]),fallback:n(()=>[i(" Loading... ")]),_:1})),C,s("ul",null,[s("li",null,[a(l,{href:"/LucasHsu.dev/database/sql/sql-join"},{default:n(()=>[i("SQL JOIN 完整指南")]),_:1}),i(" - 了解多表關聯查詢")]),s("li",null,[a(l,{href:"/LucasHsu.dev/database/database-index-basic"},{default:n(()=>[i("資料庫索引基礎")]),_:1}),i(" - 優化查詢效能")])]),o,c,s("ul",null,[s("li",null,[a(l,{href:"https://www.postgresql.org/docs/current/functions-conditional.html",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("PostgreSQL CASE 官方文件")]),_:1})]),s("li",null,[a(l,{href:"https://dev.mysql.com/doc/refman/8.0/en/flow-control-functions.html#operator_case",target:"_blank",rel:"noreferrer"},{default:n(()=>[i("MySQL CASE 語法參考")]),_:1})])]),B,a(e),a(r)])}const q=d(D,[["render",F]]);export{H as __pageData,q as default};
