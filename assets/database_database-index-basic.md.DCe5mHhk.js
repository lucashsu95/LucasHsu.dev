import{_ as E,c as D,m as s,J as n,w as i,b as p,au as e,a,V as l,E as r,o as t}from"./chunks/framework.C9sE8QFS.js";const M=JSON.parse('{"title":"資料庫索引基礎入門：從零開始理解索引原理","description":"","frontmatter":{"outline":"deep","head":[["meta",{"name":"author","content":"許恩綸"}],["meta",{"name":"keywords","content":"資料庫索引,MySQL索引,PostgreSQL索引,資料庫優化,SQL效能,索引設計"}],["meta",{"property":"og:title","content":"資料庫索引基礎入門：從零開始理解索引原理"}],["meta",{"property":"og:description","content":"完整的資料庫索引入門教學，從基礎概念到實戰應用。學習MySQL、PostgreSQL索引建立、優化技巧，提升查詢效能從O(n)到O(log n)"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"./database-index-basic-cover.png"}]]},"headers":[],"relativePath":"database/database-index-basic.md","filePath":"database/database-index-basic.md","lastUpdated":1767109375000}'),g={name:"database/database-index-basic.md"},y=l('<h1 id="資料庫索引基礎入門-從零開始理解索引原理" tabindex="-1">資料庫索引基礎入門：從零開始理解索引原理 <a class="header-anchor" href="#資料庫索引基礎入門-從零開始理解索引原理" aria-label="Permalink to &quot;資料庫索引基礎入門：從零開始理解索引原理&quot;">​</a></h1><blockquote><p>📝 <strong>TL;DR：</strong> 本文將帶你從零開始理解資料庫索引，學會如何透過建立適當的索引將查詢效能從 <code>O(n)</code> 提升到 <code>O(log n)</code>，涵蓋 MySQL、PostgreSQL 等主流資料庫的索引設計原則與最佳實踐。</p></blockquote><h2 id="文章目錄" tabindex="-1">文章目錄 <a class="header-anchor" href="#文章目錄" aria-label="Permalink to &quot;文章目錄&quot;">​</a></h2>',3),o=l(`<h2 id="為什麼需要資料庫索引" tabindex="-1">為什麼需要資料庫索引？ <a class="header-anchor" href="#為什麼需要資料庫索引" aria-label="Permalink to &quot;為什麼需要資料庫索引？&quot;">​</a></h2><p>想像一下，你要在一本厚達1000頁的字典中找到「Apple」這個單字。如果沒有索引，你只能從第一頁開始逐頁翻找，這可能需要很長時間。但如果有目錄，你可以快速定位到A開頭的部分，迅速找到目標。</p><p>資料庫索引的作用就是如此：</p><ul><li><strong>避免全表掃描</strong>：沒有索引時，資料庫必須檢查每一筆資料</li><li><strong>快速定位</strong>：有索引時，可以直接跳到目標資料位置</li><li><strong>提升效能</strong>：從<code>O(n)</code>線性查詢改善為<code>O(log n)</code>對數查詢</li></ul><h2 id="索引的基本工作原理" tabindex="-1">索引的基本工作原理 <a class="header-anchor" href="#索引的基本工作原理" aria-label="Permalink to &quot;索引的基本工作原理&quot;">​</a></h2><h3 id="_1-索引結構概念" tabindex="-1">1. 索引結構概念 <a class="header-anchor" href="#_1-索引結構概念" aria-label="Permalink to &quot;1. 索引結構概念&quot;">​</a></h3><p>資料庫索引就像圖書館的目錄系統，讓你不用逐頁翻找就能快速定位到目標。</p><p><strong>沒有索引的查詢（全表掃描）：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>資料表：[1] → [2] → [3] → [4] → [5] → ... → [10000]</span></span>
<span class="line"><span>目標：找 email = &#39;hua@email.com&#39;</span></span>
<span class="line"><span>方式：從第 1 筆開始逐一檢查  ❌ 慢！O(n)</span></span></code></pre></div><p><strong>有索引的查詢（索引查詢）：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>索引樹：        root</span></span>
<span class="line"><span>              /    \\</span></span>
<span class="line"><span>          branch  branch</span></span>
<span class="line"><span>          /   \\</span></span>
<span class="line"><span>       data  data  ✅ 快！O(log n)</span></span></code></pre></div><h3 id="_2-b-tree-索引結構詳解" tabindex="-1">2. B-Tree 索引結構詳解 <a class="header-anchor" href="#_2-b-tree-索引結構詳解" aria-label="Permalink to &quot;2. B-Tree 索引結構詳解&quot;">​</a></h3><p>B-Tree（Balanced Tree，平衡樹）是關聯式資料庫最常用的索引結構。</p><h4 id="b-tree-的層級架構" tabindex="-1">B-Tree 的層級架構 <a class="header-anchor" href="#b-tree-的層級架構" aria-label="Permalink to &quot;B-Tree 的層級架構&quot;">​</a></h4>`,14),C=l('<h4 id="b-tree-的特性" tabindex="-1">B-Tree 的特性 <a class="header-anchor" href="#b-tree-的特性" aria-label="Permalink to &quot;B-Tree 的特性&quot;">​</a></h4><ol><li><strong>平衡性</strong>：所有葉節點（Leaf Node）深度相同</li><li><strong>有序性</strong>：節點內的鍵值按順序排列</li><li><strong>範圍查詢</strong>：葉節點之間有指標連接，支援快速範圍掃描</li><li><strong>高扇出</strong>：每個節點可存儲多個鍵值，減少樹的高度</li></ol><h4 id="查詢過程示意" tabindex="-1">查詢過程示意 <a class="header-anchor" href="#查詢過程示意" aria-label="Permalink to &quot;查詢過程示意&quot;">​</a></h4>',3),B=l(`<h3 id="_3-實際範例演示" tabindex="-1">3. 實際範例演示 <a class="header-anchor" href="#_3-實際範例演示" aria-label="Permalink to &quot;3. 實際範例演示&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 假設有一個用戶表</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> users</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> PRIMARY KEY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> VARCHAR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">50</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    email </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">VARCHAR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">100</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    age </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    city </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">VARCHAR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">50</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 插入測試資料</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">INSERT INTO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">VALUES</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">張小明</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ming@email.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">25</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">台北</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">李小華</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">hua@email.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">30</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">高雄</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">王小美</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">mei@email.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">28</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">台中</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">陳小強</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">qiang@email.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">35</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">台南</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span></code></pre></div><p><strong>沒有索引的查詢（全表掃描）：</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 這個查詢會檢查所有行</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> email </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">hua@email.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 執行計劃：type: ALL, rows: 4（所有行都要檢查）</span></span></code></pre></div><h3 id="_4-建立索引後的改善" tabindex="-1">4. 建立索引後的改善 <a class="header-anchor" href="#_4-建立索引後的改善" aria-label="Permalink to &quot;4. 建立索引後的改善&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 為 email 欄位建立索引</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_user_email</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(email);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 建立後再執行相同查詢，速度大幅提升</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> email </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">hua@email.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 執行計劃：type: ref, rows: 1（只需檢查 1 行）</span></span></code></pre></div><p><strong>效能提升視覺化：</strong></p>`,7),c=s("h3",{id:"_5-索引的內部儲存",tabindex:"-1"},[a("5. 索引的內部儲存 "),s("a",{class:"header-anchor",href:"#_5-索引的內部儲存","aria-label":'Permalink to "5. 索引的內部儲存"'},"​")],-1),F=l(`<div class="tip custom-block"><p class="custom-block-title">索引的本質</p><p>索引是一個<strong>獨立的資料結構</strong>（通常是 B-Tree），它：</p><ol><li>儲存索引鍵值（如 email）和對應的資料位址</li><li>按鍵值排序，支援二分搜尋</li><li>透過指標快速定位到實際資料</li><li>是用「空間換時間」的典型案例</li></ol></div><h2 id="索引的類型與使用情境" tabindex="-1">索引的類型與使用情境 <a class="header-anchor" href="#索引的類型與使用情境" aria-label="Permalink to &quot;索引的類型與使用情境&quot;">​</a></h2><h3 id="_1-主索引-primary-index" tabindex="-1">1. 主索引（Primary Index） <a class="header-anchor" href="#_1-主索引-primary-index" aria-label="Permalink to &quot;1. 主索引（Primary Index）&quot;">​</a></h3><p>每個資料表的主鍵都會自動建立主索引：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 主鍵會自動建立唯一索引</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> products</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    product_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> PRIMARY KEY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,  </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 自動建立索引</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    product_name </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">VARCHAR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">100</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    price </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">DECIMAL</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">10</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span></code></pre></div><p><strong>使用時機</strong>：</p><ul><li>根據主鍵查詢（最常見）</li><li>關聯查詢的連接條件</li></ul><h3 id="_2-一般索引-secondary-index" tabindex="-1">2. 一般索引（Secondary Index） <a class="header-anchor" href="#_2-一般索引-secondary-index" aria-label="Permalink to &quot;2. 一般索引（Secondary Index）&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 為經常查詢的欄位建立索引</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_product_name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> products(product_name);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_product_price</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> products(price);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 適用的查詢</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> products </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> product_name </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">iPhone</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> products </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> price </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BETWEEN</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> AND</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50000</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><h3 id="_3-唯一索引-unique-index" tabindex="-1">3. 唯一索引（Unique Index） <a class="header-anchor" href="#_3-唯一索引-unique-index" aria-label="Permalink to &quot;3. 唯一索引（Unique Index）&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 確保欄位值的唯一性</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> UNIQUE INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_user_email_unique</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(email);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 這樣就無法插入重複的email</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- INSERT INTO users VALUES (5, &#39;測試&#39;, &#39;ming@email.com&#39;, 20, &#39;桃園&#39;); -- 會出錯</span></span></code></pre></div><h2 id="索引的優缺點分析" tabindex="-1">索引的優缺點分析 <a class="header-anchor" href="#索引的優缺點分析" aria-label="Permalink to &quot;索引的優缺點分析&quot;">​</a></h2><h3 id="優點" tabindex="-1">優點 <a class="header-anchor" href="#優點" aria-label="Permalink to &quot;優點&quot;">​</a></h3><ol><li><strong>大幅提升查詢速度</strong>：特別是大資料表</li><li><strong>加速排序操作</strong>：ORDER BY、GROUP BY效能提升</li><li><strong>改善JOIN效能</strong>：表與表之間的關聯查詢</li><li><strong>減少系統資源消耗</strong>：降低CPU和記憶體使用</li></ol><h3 id="缺點" tabindex="-1">缺點 <a class="header-anchor" href="#缺點" aria-label="Permalink to &quot;缺點&quot;">​</a></h3><ol><li><strong>佔用額外儲存空間</strong>：每個索引都需要存放空間</li><li><strong>降低寫入效能</strong>：INSERT、UPDATE、DELETE時需要維護索引</li><li><strong>增加維護成本</strong>：索引需要定期維護和重建</li></ol><h3 id="實際效能比較" tabindex="-1">實際效能比較 <a class="header-anchor" href="#實際效能比較" aria-label="Permalink to &quot;實際效能比較&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 測試查詢效能的方法</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">EXPLAIN </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> email </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ming@email.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 無索引結果：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- type: ALL (全表掃描)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- rows: 10000 (需要檢查的行數)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 有索引結果：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- type: ref (索引查詢)  </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- rows: 1 (只需檢查1行)</span></span></code></pre></div><h2 id="基本索引設計原則" tabindex="-1">基本索引設計原則 <a class="header-anchor" href="#基本索引設計原則" aria-label="Permalink to &quot;基本索引設計原則&quot;">​</a></h2><h3 id="_1-選擇合適的欄位建立索引" tabindex="-1">1. 選擇合適的欄位建立索引 <a class="header-anchor" href="#_1-選擇合適的欄位建立索引" aria-label="Permalink to &quot;1. 選擇合適的欄位建立索引&quot;">​</a></h3><p><strong>適合建立索引的欄位</strong>：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 經常用於WHERE條件的欄位</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_order_status</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">status</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pending</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 經常用於JOIN的欄位</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_order_user_id</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders(user_id);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders o </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">JOIN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users u </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> o</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">user_id</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> u</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">id</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 經常用於ORDER BY的欄位</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_order_created_at</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders(created_at);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ORDER BY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> created_at </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DESC</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><p><strong>不適合建立索引的欄位</strong>：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 低區分度的欄位（例如：性別、狀態碼）</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 不建議：CREATE INDEX idx_user_gender ON users(gender);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 經常更新的欄位</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 不建議：CREATE INDEX idx_user_last_login ON users(last_login_time);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 很少使用的欄位</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 不建議：CREATE INDEX idx_user_description ON users(description);</span></span></code></pre></div><h3 id="_2-索引命名規範" tabindex="-1">2. 索引命名規範 <a class="header-anchor" href="#_2-索引命名規範" aria-label="Permalink to &quot;2. 索引命名規範&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 建議的命名方式</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_table_column</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> table_name(column_name);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_users_email</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(email);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_orders_status</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">status</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 多欄位索引</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_orders_user_status</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders(user_id, </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">status</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span></code></pre></div><h2 id="常見的索引使用錯誤" tabindex="-1">常見的索引使用錯誤 <a class="header-anchor" href="#常見的索引使用錯誤" aria-label="Permalink to &quot;常見的索引使用錯誤&quot;">​</a></h2><h3 id="_1-索引失效的情況" tabindex="-1">1. 索引失效的情況 <a class="header-anchor" href="#_1-索引失效的情況" aria-label="Permalink to &quot;1. 索引失效的情況&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ 在索引欄位上使用函數</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> UPPER</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ZHANG</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 正確的做法</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Zhang</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ 使用NOT EQUAL</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> age </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">!=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 25</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 改用範圍查詢</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> age </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 25</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> OR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> age </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 25</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ LIKE使用前置通配符</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> LIKE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">%明</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 後置通配符可以使用索引</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> LIKE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">張%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><h3 id="_2-過多索引的問題" tabindex="-1">2. 過多索引的問題 <a class="header-anchor" href="#_2-過多索引的問題" aria-label="Permalink to &quot;2. 過多索引的問題&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ 為每個欄位都建立索引（過度索引）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx1</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx2</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(email); </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx3</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(age);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx4</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(city);</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx5</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(phone);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 只為常用查詢欄位建立索引</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_users_email</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(email);      </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 登入查詢</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_users_name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);        </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 姓名搜尋</span></span></code></pre></div><h2 id="實戰練習" tabindex="-1">實戰練習 <a class="header-anchor" href="#實戰練習" aria-label="Permalink to &quot;實戰練習&quot;">​</a></h2><h3 id="練習1-基本索引建立與效能分析-簡單-⭐" tabindex="-1">練習1：基本索引建立與效能分析（簡單）⭐ <a class="header-anchor" href="#練習1-基本索引建立與效能分析-簡單-⭐" aria-label="Permalink to &quot;練習1：基本索引建立與效能分析（簡單）⭐&quot;">​</a></h3><p><strong>場景設定：</strong> 假設你有一個電商系統的訂單表，包含 100 萬筆資料：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 建立測試表</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> orders</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> PRIMARY KEY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    user_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    product_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    order_date </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">DATE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> VARCHAR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">20</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    amount </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">DECIMAL</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">10</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 假設已插入 100 萬筆測試資料</span></span></code></pre></div><p><strong>任務：</strong> 以下查詢很慢，請分析需要什麼索引並建立它。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> user_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 123</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AND</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">completed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AND</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> order_date </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">2024-01-01</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><details class="details custom-block"><summary>💡 參考答案</summary><p><strong>分析步驟：</strong></p><ol><li><strong>查看執行計劃（無索引）：</strong></li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">EXPLAIN </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> user_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 123</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AND</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">completed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AND</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> order_date </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">2024-01-01</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 結果：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- type: ALL (全表掃描)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- rows: 1000000 (需檢查 100 萬行)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- Extra: Using where</span></span></code></pre></div><ol start="2"><li><strong>建立複合索引：</strong></li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 建議索引（按選擇性排序）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_orders_user_status_date</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders(user_id, </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">status</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, order_date);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 為什麼這個順序？</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 1. user_id: 等值查詢，選擇性高（假設有 10 萬使用者）</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 2. status: 等值查詢，但選擇性低（只有 pending/completed/cancelled 3 種）</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 3. order_date: 範圍查詢，放最後</span></span></code></pre></div><ol start="3"><li><strong>驗證效能提升：</strong></li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">EXPLAIN </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> orders </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> user_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 123</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AND</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> status</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">completed</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">AND</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> order_date </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">2024-01-01</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 結果：</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- type: range (索引範圍掃描)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- rows: 120 (只需檢查 120 行)</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- Extra: Using index condition</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 效能提升：1000000 / 120 ≈ 8333 倍！</span></span></code></pre></div><p><strong>效能比較：</strong></p><table><thead><tr><th>指標</th><th>無索引</th><th>有索引</th><th>提升倍數</th></tr></thead><tbody><tr><td>掃描行數</td><td>1000000</td><td>120</td><td>8333x</td></tr><tr><td>查詢時間</td><td>3000ms</td><td>5ms</td><td>600x</td></tr><tr><td>索引類型</td><td>ALL</td><td>range</td><td>-</td></tr><tr><td>I/O 次數</td><td>~30000</td><td>~10</td><td>3000x</td></tr></tbody></table></details><h3 id="練習2-索引失效問題排查-中等-⭐⭐" tabindex="-1">練習2：索引失效問題排查（中等）⭐⭐ <a class="header-anchor" href="#練習2-索引失效問題排查-中等-⭐⭐" aria-label="Permalink to &quot;練習2：索引失效問題排查（中等）⭐⭐&quot;">​</a></h3><p><strong>場景：</strong> 你已經為 <code>users</code> 表的 <code>name</code> 欄位建立了索引，但以下查詢仍然很慢。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_user_name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 慢查詢 1</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> UPPER</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ZHANG</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 慢查詢 2  </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> LIKE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">%明</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 慢查詢 3</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> age </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">+</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 35</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><p><strong>任務：</strong> 找出索引失效的原因，並提供修正方案。</p><details class="details custom-block"><summary>💡 參考答案</summary><p><strong>問題分析與解決方案：</strong></p><p><strong>1. 在索引欄位使用函數</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ 錯誤：索引失效</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> UPPER</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ZHANG</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 解法 1：改查詢條件</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Zhang</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> OR</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ZHANG</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 解法 2：建立函數索引（MySQL 8.0+）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_user_name_upper</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users((</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">UPPER</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> UPPER</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ZHANG</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;  </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 現在會使用索引</span></span></code></pre></div><p><strong>2. LIKE 使用前置通配符</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ 錯誤：索引失效</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> LIKE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">%明</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 解法 1：改用後置通配符（如果可以）</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> name</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> LIKE</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">張%</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;  </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 可用索引</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 解法 2：使用全文索引</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FULLTEXT</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> idx_user_name_fulltext </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> MATCH</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">name</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) AGAINST(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">明</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> IN</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> BOOLEAN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> MODE);</span></span></code></pre></div><p><strong>3. 在索引欄位進行運算</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ❌ 錯誤：索引失效</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> age </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">+</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 35</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- ✅ 正確：將運算移到右邊</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> users </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> age </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 25</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;  </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 可用索引</span></span></code></pre></div><p><strong>索引失效原因總結：</strong></p><table><thead><tr><th>情況</th><th>原因</th><th>解決方案</th></tr></thead><tbody><tr><td>使用函數</td><td>破壞索引順序</td><td>建立函數索引或改查詢條件</td></tr><tr><td>前置通配符</td><td>無法利用B-Tree有序性</td><td>改後置通配符或全文索引</td></tr><tr><td>欄位進行運算</td><td>無法預先計算索引值</td><td>將運算移到查詢條件右邊</td></tr><tr><td>隱式類型轉換</td><td>觸發函數轉換</td><td>確保查詢值與欄位類型一致</td></tr><tr><td>使用 OR</td><td>多個條件難以優化</td><td>改用 UNION 或 IN</td></tr><tr><td>使用 NOT、!=</td><td>需要檢查所有不符合的資料</td><td>改用範圍查詢或其他條件</td></tr></tbody></table></details><h3 id="練習3-效能基準測試實戰-中等-⭐⭐" tabindex="-1">練習3：效能基準測試實戰（中等）⭐⭐ <a class="header-anchor" href="#練習3-效能基準測試實戰-中等-⭐⭐" aria-label="Permalink to &quot;練習3：效能基準測試實戰（中等）⭐⭐&quot;">​</a></h3><p><strong>任務：</strong> 比較不同資料量下，有索引與無索引的查詢效能差異。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 建立測試表並插入不同數量的資料</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> test_performance</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> PRIMARY KEY</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    user_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    email </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">VARCHAR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">100</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    created_at </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DATETIME</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 插入測試資料的程序（示例）</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">DELIMITER $$</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> PROCEDURE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> insert_test_data(</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">IN</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> num_rows </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    DECLARE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> i </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">INT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> DEFAULT</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHILE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> i </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> num_rows DO</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        INSERT INTO</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> test_performance (user_id, email, created_at)</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        VALUES</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            FLOOR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">RAND</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">() </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 10000</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">            CONCAT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">user</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, i, </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">@test.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">),</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">            NOW</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">()</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> INTERVAL </span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">FLOOR</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">RAND</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">() </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">*</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 365</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">) </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">DAY</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        );</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">        SET</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> i </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> i </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">+</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    END</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> WHILE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">END</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">$$</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">DELIMITER ;</span></span></code></pre></div><p><strong>測試步驟：</strong></p><ol><li>測試不同資料量（1000, 10000, 100000, 1000000 筆）</li><li>分別測試有索引和無索引的查詢時間</li><li>記錄並比較結果</li></ol>`,48),u={class:"details custom-block"},m=l(`<summary>💡 參考答案與測試腳本</summary><p><strong>完整測試腳本：</strong></p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 1. 清空表格並插入測試資料</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">TRUNCATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> TABLE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> test_performance;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CALL</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> insert_test_data(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">100000</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">);  </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 插入 10 萬筆</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 2. 測試無索引的效能</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> BENCHMARK(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1000</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, (</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> test_performance </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> user_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> LIMIT</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">));</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 記錄耗時</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 3. 建立索引</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">CREATE</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> INDEX</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> idx_user_id</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> ON</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> test_performance(user_id);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 4. 測試有索引的效能</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> BENCHMARK(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1000</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">, (</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> test_performance </span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">    WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> user_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5000</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> LIMIT</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">));</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 記錄耗時並比較</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- 5. 查看索引使用情況</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">EXPLAIN </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> test_performance </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> user_id </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5000</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><p><strong>測試結果範例：</strong></p><table><thead><tr><th>資料筆數</th><th>無索引耗時</th><th>有索引耗時</th><th>效能提升</th><th>掃描行數（無/有）</th></tr></thead><tbody><tr><td>1,000</td><td>2ms</td><td>1ms</td><td>2x</td><td>1000 / 1</td></tr><tr><td>10,000</td><td>25ms</td><td>1ms</td><td>25x</td><td>10000 / 1</td></tr><tr><td>100,000</td><td>300ms</td><td>2ms</td><td>150x</td><td>100000 / 10</td></tr><tr><td>1,000,000</td><td>3,500ms</td><td>3ms</td><td>1167x</td><td>1000000 / 100</td></tr></tbody></table><p><strong>重要發現：</strong></p><ol><li>資料量越大，索引的效能提升越顯著</li><li>無索引的時間複雜度：O(n) - 線性成長</li><li>有索引的時間複雜度：O(log n) - 對數成長</li><li>當資料量達到 100 萬筆時，效能差距達到 <strong>1000 倍以上</strong></li></ol><p><strong>視覺化比較：</strong></p>`,8),_=s("p",null,[s("strong",null,"結論：")],-1),b=s("ul",null,[s("li",null,"小表（< 1000 筆）：索引效益不明顯"),s("li",null,"中表（1 萬 - 10 萬筆）：建議建立索引"),s("li",null,[a("大表（> 10 萬筆）："),s("strong",null,"必須建立索引")])],-1),R=l('<h2 id="總結" tabindex="-1">總結 <a class="header-anchor" href="#總結" aria-label="Permalink to &quot;總結&quot;">​</a></h2><p>資料庫索引是提升查詢效能的關鍵工具，讓我們回顧核心要點：</p><ol><li><strong>索引就像目錄</strong>：讓你快速定位資料，從 O(n) 提升到 O(log n)</li><li><strong>B-Tree 是主流</strong>：平衡樹結構，支援範圍查詢和排序</li><li><strong>選對欄位建索引</strong>：經常用於 WHERE、JOIN、ORDER BY 的欄位</li><li><strong>避免索引失效</strong>：不要在索引欄位使用函數或運算</li><li><strong>平衡讀寫效能</strong>：索引提升讀取，但會降低寫入速度</li><li><strong>定期維護</strong>：大量資料變更後需要重建索引</li></ol>',3),v={class:"tip custom-block"},T=s("p",{class:"custom-block-title"},"下一步",-1),N=l(`<h2 id="常見問題-faq" tabindex="-1">常見問題 FAQ <a class="header-anchor" href="#常見問題-faq" aria-label="Permalink to &quot;常見問題 FAQ&quot;">​</a></h2><h3 id="q1-什麼時候應該建立資料庫索引" tabindex="-1">Q1: 什麼時候應該建立資料庫索引？ <a class="header-anchor" href="#q1-什麼時候應該建立資料庫索引" aria-label="Permalink to &quot;Q1: 什麼時候應該建立資料庫索引？&quot;">​</a></h3><p><strong>A:</strong> 當以下情況發生時，建議建立索引：</p><ul><li>表格資料量超過 1000 筆且有頻繁查詢需求</li><li>經常使用 WHERE、JOIN、ORDER BY 的欄位</li><li>查詢回應時間超過可接受範圍（通常 &gt; 100ms）</li></ul><h3 id="q2-索引越多越好嗎" tabindex="-1">Q2: 索引越多越好嗎？ <a class="header-anchor" href="#q2-索引越多越好嗎" aria-label="Permalink to &quot;Q2: 索引越多越好嗎？&quot;">​</a></h3><p><strong>A:</strong> 不是。過多索引會：</p><ul><li>佔用額外儲存空間（通常索引大小為原表 10-30%）</li><li>降低 INSERT、UPDATE、DELETE 效能</li><li>增加維護成本 建議遵循「80/20 法則」，為 20% 最常用的查詢建立索引。</li></ul><h3 id="q3-mysql-和-postgresql-的索引有什麼差異" tabindex="-1">Q3: MySQL 和 PostgreSQL 的索引有什麼差異？ <a class="header-anchor" href="#q3-mysql-和-postgresql-的索引有什麼差異" aria-label="Permalink to &quot;Q3: MySQL 和 PostgreSQL 的索引有什麼差異？&quot;">​</a></h3><p><strong>A:</strong> 主要差異包括：</p><ul><li><strong>MySQL</strong>：主要使用 B+Tree，InnoDB 引擎支援聚集索引</li><li><strong>PostgreSQL</strong>：支援更多索引類型（GiST、GIN、SP-GiST、BRIN）</li><li><strong>語法</strong>：基本 CREATE INDEX 語法相同，但進階功能略有差異</li></ul><h3 id="q4-如何檢查索引是否有效" tabindex="-1">Q4: 如何檢查索引是否有效？ <a class="header-anchor" href="#q4-如何檢查索引是否有效" aria-label="Permalink to &quot;Q4: 如何檢查索引是否有效？&quot;">​</a></h3><p><strong>A:</strong> 可以使用以下方法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- MySQL</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">EXPLAIN </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> table_name </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> column </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">value</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-- PostgreSQL  </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">EXPLAIN ANALYZE </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">SELECT</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> FROM</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> table_name </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">WHERE</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> column </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">value</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">;</span></span></code></pre></div><p>查看 <code>type</code> 欄位，<code>const</code> 或 <code>ref</code> 表示使用索引，<code>ALL</code> 表示全表掃描。</p><h3 id="q5-複合索引的欄位順序重要嗎" tabindex="-1">Q5: 複合索引的欄位順序重要嗎？ <a class="header-anchor" href="#q5-複合索引的欄位順序重要嗎" aria-label="Permalink to &quot;Q5: 複合索引的欄位順序重要嗎？&quot;">​</a></h3><p><strong>A:</strong> 非常重要！應該遵循：</p><ol><li><strong>選擇性高的欄位放前面</strong>（cardinality 高）</li><li><strong>等值條件在前，範圍條件在後</strong></li><li><strong>最常用的查詢條件放最左邊</strong></li></ol><h2 id="效能基準測試結果" tabindex="-1">效能基準測試結果 <a class="header-anchor" href="#效能基準測試結果" aria-label="Permalink to &quot;效能基準測試結果&quot;">​</a></h2><table><thead><tr><th>資料量</th><th>無索引查詢時間</th><th>有索引查詢時間</th><th>效能提升</th></tr></thead><tbody><tr><td>1,000 筆</td><td>2ms</td><td>1ms</td><td>2x</td></tr><tr><td>10,000 筆</td><td>25ms</td><td>1ms</td><td>25x</td></tr><tr><td>100,000 筆</td><td>300ms</td><td>1ms</td><td>300x</td></tr><tr><td>1,000,000 筆</td><td>3,000ms</td><td>2ms</td><td>1,500x</td></tr></tbody></table><p><em>測試環境：MySQL 8.0，Intel i7 CPU，16GB RAM，SSD 硬碟</em></p><h2 id="延伸閱讀" tabindex="-1">延伸閱讀 <a class="header-anchor" href="#延伸閱讀" aria-label="Permalink to &quot;延伸閱讀&quot;">​</a></h2>`,21);function q(L,I,f,x,O,P){const h=r("VPNolebaseInlineLinkPreview"),k=r("Mermaid"),d=r("NolebaseGitContributors"),A=r("NolebaseGitChangelog");return t(),D("div",null,[y,s("ol",null,[s("li",null,[n(h,{href:"#為什麼需要資料庫索引"},{default:i(()=>[a("為什麼需要資料庫索引？")]),_:1})]),s("li",null,[n(h,{href:"#索引的基本工作原理"},{default:i(()=>[a("索引的基本工作原理")]),_:1})]),s("li",null,[n(h,{href:"#索引的類型與使用情境"},{default:i(()=>[a("索引的類型與使用情境")]),_:1})]),s("li",null,[n(h,{href:"#索引的優缺點分析"},{default:i(()=>[a("索引的優缺點分析")]),_:1})]),s("li",null,[n(h,{href:"#基本索引設計原則"},{default:i(()=>[a("基本索引設計原則")]),_:1})]),s("li",null,[n(h,{href:"#常見的索引使用錯誤"},{default:i(()=>[a("常見的索引使用錯誤")]),_:1})]),s("li",null,[n(h,{href:"#實戰練習"},{default:i(()=>[a("實戰練習")]),_:1})]),s("li",null,[n(h,{href:"#常見問題-faq"},{default:i(()=>[a("常見問題 FAQ")]),_:1})])]),o,(t(),p(e,null,{default:i(()=>[n(k,{id:"mermaid-105",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20Root%5BRoot%20Node%3Cbr%2F%3E%E6%A0%B9%E7%AF%80%E9%BB%9E%3Cbr%2F%3E10%2C%2020%2C%2030%5D%0A%20%20%20%20%0A%20%20%20%20Branch1%5BBranch%20Node%3Cbr%2F%3E5%2C%207%5D%0A%20%20%20%20Branch2%5BBranch%20Node%3Cbr%2F%3E15%2C%2017%5D%0A%20%20%20%20Branch3%5BBranch%20Node%3Cbr%2F%3E25%2C%2027%5D%0A%20%20%20%20Branch4%5BBranch%20Node%3Cbr%2F%3E35%2C%2037%5D%0A%20%20%20%20%0A%20%20%20%20Leaf1%5BLeaf%3Cbr%2F%3E1%2C2%2C3%2C4%5D%0A%20%20%20%20Leaf2%5BLeaf%3Cbr%2F%3E5%2C6%5D%0A%20%20%20%20Leaf3%5BLeaf%3Cbr%2F%3E7%2C8%2C9%5D%0A%20%20%20%20Leaf4%5BLeaf%3Cbr%2F%3E11%2C12%2C13%5D%0A%20%20%20%20Leaf5%5BLeaf%3Cbr%2F%3E15%2C16%5D%0A%20%20%20%20Leaf6%5BLeaf%3Cbr%2F%3E17%2C18%2C19%5D%0A%20%20%20%20Leaf7%5BLeaf%3Cbr%2F%3E21%2C22%2C23%5D%0A%20%20%20%20Leaf8%5BLeaf%3Cbr%2F%3E25%2C26%5D%0A%20%20%20%20%0A%20%20%20%20Root%20--%3E%20Branch1%0A%20%20%20%20Root%20--%3E%20Branch2%0A%20%20%20%20Root%20--%3E%20Branch3%0A%20%20%20%20Root%20--%3E%20Branch4%0A%20%20%20%20%0A%20%20%20%20Branch1%20--%3E%20Leaf1%0A%20%20%20%20Branch1%20--%3E%20Leaf2%0A%20%20%20%20Branch1%20--%3E%20Leaf3%0A%20%20%20%20%0A%20%20%20%20Branch2%20--%3E%20Leaf4%0A%20%20%20%20Branch2%20--%3E%20Leaf5%0A%20%20%20%20Branch2%20--%3E%20Leaf6%0A%20%20%20%20%0A%20%20%20%20Branch3%20--%3E%20Leaf7%0A%20%20%20%20Branch3%20--%3E%20Leaf8%0A"})]),fallback:i(()=>[a(" Loading... ")]),_:1})),C,(t(),p(e,null,{default:i(()=>[n(k,{id:"mermaid-134",class:"mermaid",graph:"sequenceDiagram%0A%20%20%20%20participant%20Q%20as%20%E6%9F%A5%E8%A9%A2%0A%20%20%20%20participant%20R%20as%20Root%20Node%0A%20%20%20%20participant%20B%20as%20Branch%20Node%0A%20%20%20%20participant%20L%20as%20Leaf%20Node%0A%20%20%20%20participant%20D%20as%20%E8%B3%87%E6%96%99%E9%A0%81%0A%20%20%20%20%0A%20%20%20%20Q-%3E%3ER%3A%201.%20%E6%9F%A5%E8%A9%A2%20email%3D'hua%40email.com'%0A%20%20%20%20R-%3E%3ER%3A%202.%20%E6%AF%94%E8%BC%83%E9%8D%B5%E5%80%BC%EF%BC%8C%E6%B1%BA%E5%AE%9A%E5%BE%80%E5%93%AA%E5%80%8B%E5%88%86%E6%94%AF%0A%20%20%20%20R-%3E%3EB%3A%203.%20%E9%80%B2%E5%85%A5%E5%B0%8D%E6%87%89%E7%9A%84%20Branch%20Node%0A%20%20%20%20B-%3E%3EB%3A%204.%20%E7%B9%BC%E7%BA%8C%E6%AF%94%E8%BC%83%E9%8D%B5%E5%80%BC%0A%20%20%20%20B-%3E%3EL%3A%205.%20%E9%80%B2%E5%85%A5%20Leaf%20Node%0A%20%20%20%20L-%3E%3EL%3A%206.%20%E6%89%BE%E5%88%B0%E7%B4%A2%E5%BC%95%E8%A8%98%E9%8C%84%0A%20%20%20%20L-%3E%3ED%3A%207.%20%E6%A0%B9%E6%93%9A%E6%8C%87%E6%A8%99%E8%AE%80%E5%8F%96%E5%AF%A6%E9%9A%9B%E8%B3%87%E6%96%99%0A%20%20%20%20D-%3E%3EQ%3A%208.%20%E8%BF%94%E5%9B%9E%E6%9F%A5%E8%A9%A2%E7%B5%90%E6%9E%9C%0A%20%20%20%20%0A%20%20%20%20Note%20over%20Q%2CD%3A%20%E7%B8%BD%E5%85%B1%E5%8F%AA%E9%9C%80%203-4%20%E6%AC%A1%20I%2FO%EF%BC%81%0A"})]),fallback:i(()=>[a(" Loading... ")]),_:1})),B,(t(),p(e,null,{default:i(()=>[n(k,{id:"mermaid-150",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20A%5B%E6%9F%A5%E8%A9%A2%E8%AB%8B%E6%B1%82%5D%20--%3E%20B%7B%E6%9C%89%E7%B4%A2%E5%BC%95%3F%7D%0A%20%20%20%20B%20--%3E%7C%E7%84%A1%E7%B4%A2%E5%BC%95%7C%20C%5B%E5%85%A8%E8%A1%A8%E6%8E%83%E6%8F%8F%20%E2%8F%B1%EF%B8%8F%20300ms%3Cbr%2F%3E%E6%AA%A2%E6%9F%A5%2010000%20%E7%AD%86%5D%0A%20%20%20%20B%20--%3E%7C%E6%9C%89%E7%B4%A2%E5%BC%95%7C%20D%5B%E7%B4%A2%E5%BC%95%E6%9F%A5%E8%A9%A2%20%E2%8F%B1%EF%B8%8F%202ms%3Cbr%2F%3E%E6%AA%A2%E6%9F%A5%201%20%E7%AD%86%5D%0A%20%20%20%20%0A%20%20%20%20C%20--%3E%20E%5B%E2%9D%8C%20%E6%85%A2%20150%20%E5%80%8D%5D%0A%20%20%20%20D%20--%3E%20F%5B%E2%9C%85%20%E5%BF%AB%E9%80%9F%E5%9B%9E%E6%87%89%5D%0A"})]),fallback:i(()=>[a(" Loading... ")]),_:1})),c,(t(),p(e,null,{default:i(()=>[n(k,{id:"mermaid-154",class:"mermaid",graph:"graph%20LR%0A%20%20%20%20subgraph%20%E7%B4%A2%E5%BC%95%E6%AA%94%E6%A1%88%20idx_user_email%0A%20%20%20%20%20%20%20%20I1%5Bming%40email.com%20%E2%86%92%20Row%201%5D%0A%20%20%20%20%20%20%20%20I2%5Bhua%40email.com%20%E2%86%92%20Row%202%5D%0A%20%20%20%20%20%20%20%20I3%5Bmei%40email.com%20%E2%86%92%20Row%203%5D%0A%20%20%20%20%20%20%20%20I4%5Bqiang%40email.com%20%E2%86%92%20Row%204%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20subgraph%20%E8%B3%87%E6%96%99%E8%A1%A8%20users%0A%20%20%20%20%20%20%20%20R1%5BRow%201%3A%20%E5%BC%B5%E5%B0%8F%E6%98%8E%2C%2025%2C%20%E5%8F%B0%E5%8C%97%5D%0A%20%20%20%20%20%20%20%20R2%5BRow%202%3A%20%E6%9D%8E%E5%B0%8F%E8%8F%AF%2C%2030%2C%20%E9%AB%98%E9%9B%84%5D%0A%20%20%20%20%20%20%20%20R3%5BRow%203%3A%20%E7%8E%8B%E5%B0%8F%E7%BE%8E%2C%2028%2C%20%E5%8F%B0%E4%B8%AD%5D%0A%20%20%20%20%20%20%20%20R4%5BRow%204%3A%20%E9%99%B3%E5%B0%8F%E5%BC%B7%2C%2035%2C%20%E5%8F%B0%E5%8D%97%5D%0A%20%20%20%20end%0A%20%20%20%20%0A%20%20%20%20I1%20-.%E6%8C%87%E6%A8%99.-%3E%20R1%0A%20%20%20%20I2%20-.%E6%8C%87%E6%A8%99.-%3E%20R2%0A%20%20%20%20I3%20-.%E6%8C%87%E6%A8%99.-%3E%20R3%0A%20%20%20%20I4%20-.%E6%8C%87%E6%A8%99.-%3E%20R4%0A"})]),fallback:i(()=>[a(" Loading... ")]),_:1})),F,s("details",u,[m,(t(),p(e,null,{default:i(()=>[n(k,{id:"mermaid-685",class:"mermaid",graph:"graph%20TD%0A%20%20%20%20A%5B%E8%B3%87%E6%96%99%E9%87%8F%5D%20--%3E%20B%5B1%2C000%20%E7%AD%86%5D%0A%20%20%20%20A%20--%3E%20C%5B10%2C000%20%E7%AD%86%5D%0A%20%20%20%20A%20--%3E%20D%5B100%2C000%20%E7%AD%86%5D%0A%20%20%20%20A%20--%3E%20E%5B1%2C000%2C000%20%E7%AD%86%5D%0A%20%20%20%20%0A%20%20%20%20B%20--%3E%20B1%5B%E7%84%A1%E7%B4%A2%E5%BC%95%3A%202ms%3Cbr%2F%3E%E6%9C%89%E7%B4%A2%E5%BC%95%3A%201ms%3Cbr%2F%3E%E6%8F%90%E5%8D%87%3A%202x%5D%0A%20%20%20%20C%20--%3E%20C1%5B%E7%84%A1%E7%B4%A2%E5%BC%95%3A%2025ms%3Cbr%2F%3E%E6%9C%89%E7%B4%A2%E5%BC%95%3A%201ms%3Cbr%2F%3E%E6%8F%90%E5%8D%87%3A%2025x%5D%0A%20%20%20%20D%20--%3E%20D1%5B%E7%84%A1%E7%B4%A2%E5%BC%95%3A%20300ms%3Cbr%2F%3E%E6%9C%89%E7%B4%A2%E5%BC%95%3A%202ms%3Cbr%2F%3E%E6%8F%90%E5%8D%87%3A%20150x%5D%0A%20%20%20%20E%20--%3E%20E1%5B%E7%84%A1%E7%B4%A2%E5%BC%95%3A%203500ms%3Cbr%2F%3E%E6%9C%89%E7%B4%A2%E5%BC%95%3A%203ms%3Cbr%2F%3E%E6%8F%90%E5%8D%87%3A%201167x%5D%0A"})]),fallback:i(()=>[a(" Loading... ")]),_:1})),_,b]),R,s("div",v,[T,s("p",null,[a("掌握基礎索引概念後，建議閱讀"),n(h,{href:"/LucasHsu.dev/database/database-index-advanced"},{default:i(()=>[a("進階索引實戰")]),_:1}),a("，學習複合索引、Hash 索引和效能調優技巧！")])]),N,s("ul",null,[s("li",null,[n(h,{href:"https://dev.mysql.com/doc/refman/8.0/en/optimization-indexes.html",target:"_blank",rel:"noreferrer"},{default:i(()=>[a("MySQL 8.0 官方索引文檔")]),_:1})]),s("li",null,[n(h,{href:"https://www.postgresql.org/docs/current/indexes.html",target:"_blank",rel:"noreferrer"},{default:i(()=>[a("PostgreSQL 索引優化指南")]),_:1})]),s("li",null,[n(h,{href:"https://use-the-index-luke.com/",target:"_blank",rel:"noreferrer"},{default:i(()=>[a("資料庫效能調優最佳實踐")]),_:1})])]),n(d),n(A)])}const H=E(g,[["render",q]]);export{M as __pageData,H as default};
