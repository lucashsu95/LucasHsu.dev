# å½ˆè·³è¦–çª— (Modal)

> ğŸ“ TL;DR
- Modal = ç–Šåœ¨é é¢ä¸Šçš„ç„¦é»å°è©±æ¡†ï¼Œå‹™å¿…è™•ç†ã€Œé–‹å•Ÿ/é—œé–‰ã€ç„¦é»é–å®šã€èƒŒæ™¯é®ç½©ã€Esc/é»æ“ŠèƒŒæ™¯é—œé–‰ã€ã€‚
- åˆ¥ç”¨ `display: none` è—ç„¦é»ï¼šåŠ ä¸Š `aria-modal="true"`ã€`role="dialog"`ï¼Œä¸¦åœ¨é–‹å•Ÿæ™‚æŠŠç„¦é»ç§»åˆ°å°è©±æ¡†ã€‚
- é€²éšï¼šå¤šå±¤ Modalã€å¯æ²å…§å®¹ã€é˜»æ­¢èƒŒæ™¯æ²å‹•ã€å‹•æ…‹æ’å…¥å…§å®¹ã€‚

## ä»€éº¼æ™‚å€™ä½¿ç”¨ Modalï¼Ÿ
- ç¢ºèªé¡è¡Œç‚ºï¼šåˆªé™¤ã€é›¢é–‹å‰æç¤º
- é›†ä¸­æ³¨æ„ï¼šè¡¨å–®ã€ç™»å…¥ã€å¿«é€Ÿæª¢è¦–å•†å“
- éé˜»å¡è³‡è¨Šä¸è©²ç”¨ Modalï¼šæç¤ºå¯ç”¨ Toast/Inline

## æœ€å°å¯ç”¨ç‰ˆæœ¬ (åŸç”Ÿ JS)

```html
<button id="open">é–‹å•Ÿè¦–çª—</button>

<div id="modal" class="backdrop" hidden>
	<div class="dialog" role="dialog" aria-modal="true" aria-labelledby="title">
		<h2 id="title">ç¢ºèªåˆªé™¤ï¼Ÿ</h2>
		<p>åˆªé™¤å¾Œç„¡æ³•å¾©åŸã€‚</p>
		<button id="confirm">ç¢ºå®š</button>
		<button id="close">å–æ¶ˆ</button>
	</div>
</div>

<style>
.backdrop {
	position: fixed; inset: 0; display: grid; place-items: center;
	background: rgba(0,0,0,0.45);
}
.dialog {
	min-width: 320px; padding: 24px; border-radius: 12px;
	background: white; box-shadow: 0 12px 32px rgba(0,0,0,0.2);
}
</style>

<script>
const modal = document.getElementById('modal')
const openBtn = document.getElementById('open')
const closeBtn = document.getElementById('close')
const confirmBtn = document.getElementById('confirm')

function openModal() {
	modal.hidden = false
	document.body.style.overflow = 'hidden' // é–å®šèƒŒæ™¯æ»¾å‹•
	modal.querySelector('button').focus()
}

function closeModal() {
	modal.hidden = true
	document.body.style.overflow = ''
	openBtn.focus()
}

openBtn.addEventListener('click', openModal)
closeBtn.addEventListener('click', closeModal)
confirmBtn.addEventListener('click', () => {
	alert('å·²åˆªé™¤')
	closeModal()
})

modal.addEventListener('click', (e) => {
	if (e.target === modal) closeModal() // é»æ“ŠèƒŒæ™¯é—œé–‰
})

document.addEventListener('keydown', (e) => {
	if (e.key === 'Escape' && !modal.hidden) closeModal()
})
</script>
```

## æ¨¡å¼è¨­è¨ˆæ¸…å–®
- é–‹å•Ÿ/é—œé–‰ï¼šæŒ‰éˆ•ã€Escã€èƒŒæ™¯é»æ“Š
- ç„¦é»ç®¡ç†ï¼šé–‹å•Ÿæ™‚èšç„¦é¦–å€‹å¯äº’å‹•å…ƒç´ ï¼›é—œé–‰æ™‚é‚„åŸåˆ°è§¸ç™¼æº
- æ»¾å‹•æ§åˆ¶ï¼šé–‹å•Ÿæ™‚ `body` ç¦æ­¢æ»¾å‹•ï¼Œé•·å…§å®¹å¯åœ¨å°è©±æ¡†å…§æ»¾
- å‹•ç•«ï¼šæ·¡å…¥/ç¸®æ”¾å³å¯ï¼Œé¿å…éåº¦ç¹è¤‡

## å¯¦æˆ°ç·´ç¿’

### ç·´ç¿’ 1ï¼šèƒŒæ™¯é»æ“Šé—œé–‰ï¼ˆç°¡å–®ï¼‰â­
> ç‚ºç¾æœ‰ Modal åŠ ä¸Šã€Œé»æ“Šé®ç½©å³é—œé–‰ã€ã€‚

:::details ğŸ’¡ åƒè€ƒç­”æ¡ˆ
```javascript
modal.addEventListener('click', (e) => {
	if (e.target === modal) closeModal()
})
```
:::

### ç·´ç¿’ 2ï¼šé˜»æ­¢èƒŒæ™¯æ»¾å‹•ï¼ˆç°¡å–®ï¼‰â­
> é–‹å•Ÿ Modal æ™‚ç¦æ­¢ `body` æ»¾å‹•ï¼Œé—œé–‰å¾Œæ¢å¾©ã€‚

:::details ğŸ’¡ åƒè€ƒç­”æ¡ˆ
```javascript
function openModal() { modal.hidden = false; document.body.style.overflow = 'hidden' }
function closeModal() { modal.hidden = true; document.body.style.overflow = '' }
```
:::

### ç·´ç¿’ 3ï¼šç„¦é»åœˆï¼ˆä¸­ç­‰ï¼‰â­â­
> å¯¦ä½œç„¦é»é–å®šï¼šæŒ‰ Tab æ™‚ç„¦é»åœ¨å°è©±æ¡†å…§å¾ªç’°ï¼Œä¸æœƒè·‘å›èƒŒæ™¯ã€‚

:::details ğŸ’¡ åƒè€ƒç­”æ¡ˆèˆ‡æç¤º
**æç¤ºï¼š** æ”¶é›† dialog å…§å¯èšç„¦å…ƒç´ ï¼Œç›£è½ keydown Tabã€‚
```javascript
const focusables = modal.querySelectorAll('button, [href], input, select, textarea')
modal.addEventListener('keydown', (e) => {
	if (e.key !== 'Tab') return
	const first = focusables[0]
	const last = focusables[focusables.length - 1]
	if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus() }
	if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus() }
})
```
:::

## å»¶ä¼¸é–±è®€
- ARIA Authoring Practices: [Dialog (Modal) Pattern](https://www.w3.org/WAI/ARIA/apg/patterns/dialog-modal/)
- Inclusive Components: [The Toggle](https://inclusive-components.design/menus-menu-buttons/)ï¼ˆå«ç„¦é»ç®¡ç†æŠ€å·§ï¼‰
- MUI / Radix UI çš„å°è©±æ¡†å…ƒä»¶å¯¦ä½œï¼Œåƒè€ƒå…¶ API è¨­è¨ˆ

## FAQ
- Q: Modal å…§å¯æ»¾ï¼ŒèƒŒæ™¯ä¹Ÿæœƒæ»¾ï¼Ÿ
	- A: é–‹å•Ÿæ™‚è¨­ `body { overflow: hidden; }`ï¼Œå…§å®¹å®¹å™¨å†è¨­ `max-height` + `overflow: auto`ã€‚
- Q: å¤šå±¤ Modal æ€éº¼è™•ç†ï¼Ÿ
	- A: ç®¡ç† z-index éšå±¤ï¼Œä¸¦åªé–å®šæœ€ä¸Šå±¤çš„ç„¦é»èˆ‡é—œé–‰è¡Œç‚ºã€‚
- Q: SEO æœƒå—å½±éŸ¿å—ï¼Ÿ
	- A: Modal å…§å®¹é€šå¸¸éä¸»è¦æ–‡æ¡ˆï¼Œé‡é»æ˜¯å¯åŠæ€§ï¼›ä¿ç•™å¯é—œé–‰é€”å¾‘å³å¯ã€‚